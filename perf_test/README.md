# Результаты нагрузочного тестирования API

## Сводная таблица результатов тестирования эндпоинта `POST /api/createCourse` с разным количеством соединений:

Пример команды для тестирования: wrk -t1 -c20 -d1500s --timeout 15s --latency -s payload.lua http://217.16.21.64:8080/api/createCourse
(скрипт payload.lua лежит в этой же директории)

| Метрика               | Значение       |
|-----------------------|----------------|
| **Общее время работы** | 25 минут      |
| **Всего запросов**    | 116,905        |
| **CPU сервера БД**    | 100%           |
| **Чтение данных**     | 42.48 MB       |
| **Средняя задержка**  | 257.17 ms      |
| **Макс. задержка**    | 980.15 ms      |

Для создания одного экземпляра курса серверу приходилось записывать данные в 6 разных таблиц

## Сводная таблица результатов тестирования эндпоинта `GET /api/getCourses` с разным количеством соединений:

Пример команды для тестирования: wrk -t1 -c50 -d30s --timeout 15s --latency http://217.16.21.64:8080/api/getCourses

| Connections | Avg Latency | 90% Latency | Requests/sec | Transfer/sec | Эффективность       |
|-------------|-------------|-------------|--------------|--------------|---------------------|
| 50          | 1030 ms     | 1440 ms     | 47.79        | 409.47 KB/s  | ❌ Перегрузка       |
| 30          | 590 ms      | 788 ms      | 50.21        | 430.24 KB/s  | ⚠️ Высокая нагрузка  |
| 20          | 359 ms      | 481 ms      | 55.34        | 474.20 KB/s  | ⚠️ На пределе        |
| 15          | 255 ms      | 342 ms      | 58.46        | 500.93 KB/s  | ✅ Оптимально       |
| 10          | 163 ms      | 216 ms      | 61.03        | 522.89 KB/s  | ✅ Хорошо           |
| 5           | 80 ms       | 105 ms      | 62.22        | 533.09 KB/s  | ✅ Хорошо           |
| 4           | 65 ms       | 87 ms       | 61.73        | 528.95 KB/s  | ✅ Хорошо           |

## Анализ результатов

1. **Оптимальный диапазон**: 10-15 соединений
   - Латентность: 160-255 ms
   - RPS достигает максимума (58-61)

2. **Точка перегрузки**: 20+ соединений
   - При >20 соединениях латенси резко растет
   - При 50 соединениях сервер не справляется (latency >1s)

## Сводная таблица результатов тестирования эндпоинта `GET /api/getCourse` с разным количеством соединений:

Пример команды для тестирования: wrk -t1 -c70 -d30s --timeout 15s --latency http://217.16.21.64:8080/api/getCourse?courseId=275667

| Connections | Avg Latency | 90% Latency | Requests/sec | Transfer/sec | Эффективность       |
|-------------|-------------|-------------|--------------|--------------|---------------------|
| 70          | 530.63 ms   | 1.18 s      | 144.63       | 126.97 KB/s  | ❌ Перегрузка       |
| 60          | 448.54 ms   | 1.06 s      | 154.69       | 135.81 KB/s  | ❌ Перегрузка       |
| 50          | 365.16 ms   | 867.77 ms   | 159.82       | 140.31 KB/s  | ⚠️ Высокая нагрузка  |
| 40          | 286.20 ms   | 699.40 ms   | 166.31       | 146.01 KB/s  | ⚠️ На пределе        |
| 30          | 212.82 ms   | 495.19 ms   | 161.48       | 141.77 KB/s  | ✅ Хорошо           |
| 20          | 135.95 ms   | 301.83 ms   | 160.45       | 140.86 KB/s  | ✅ Хорошо           |
| 10          | 63.86 ms    | 134.35 ms   | 167.44       | 147.00 KB/s  | ✅ Хорошо           |

## Анализ результатов

1. **Оптимальный диапазон**: 10-30 соединений
   - Латентность: 64-213 ms
   - RPS стабильно высокий (160-167)
   - 90-й перцентиль <500 ms

2. **Точка перегрузки**: 40+ соединений
   - При 40 соединениях 90% latency достигает 700ms
   - При 70 соединениях сервер не справляется (latency >1s)


## Возможные оптимизации для нашего сервиса:
   - Необходимо добавить кэширование частых запросов
   - Поработать с таймаутами на сервер
   - Добавить индексы
   - Возможно поменять роутер на сервере на более быстрый